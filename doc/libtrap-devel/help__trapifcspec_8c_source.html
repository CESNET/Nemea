<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Libtrap: Internal development docs: src/help_trapifcspec.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Libtrap: Internal development docs
   &#160;<span id="projectnumber">0.11.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">help_trapifcspec.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="help__trapifcspec_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="help__trapifcspec_8c.html#ad42ed2f9863287a22ef816d79e4cc4ab">    1</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="help__trapifcspec_8c.html#ad42ed2f9863287a22ef816d79e4cc4ab">trap_help_ifcspec</a> = <span class="stringliteral">&quot;Format of TRAP interface specifier (IFC_SPEC):\n&quot;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;   <span class="stringliteral">&quot;==============================================\n&quot;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;   <span class="stringliteral">&quot;TRAP interface specifier is an argument of `-i` option used by every NEMEA module. It specifies a configuration of module&#39;s TRAP interfaces (IFC), i.e. what kind of IFC to use and where to connect.\n&quot;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;   <span class="stringliteral">&quot;Configurations of individual IFCs are separated by comma `,`, e.g. `&lt;IFC 1&gt;,&lt;IFC 2&gt;,...,&lt;IFC N&gt;`. Input IFCs must be specified first, output IFCs follow. The number of input and output IFCs depends on the specific module (you should be able to find it in the module&#39;s help or README).\n&quot;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;   <span class="stringliteral">&quot;Parameters of each IFC are separated by colon `:`, e.g. `&lt;type&gt;:&lt;par1&gt;:&lt;par2&gt;:...:&lt;parN&gt;`. The first parameter is always one character specifying the type of the IFC to use, other parameters differ for individual types (see below).\n&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;   <span class="stringliteral">&quot;Example of startup of a module with 1 input and 1 output IFC:\n&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;   <span class="stringliteral">&quot;traffic_repeater -i t:example.org:1234,u:my_socket\n&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;   <span class="stringliteral">&quot;The example makes the repeater to use a TCP socket as its input IFC and connect it to &#39;example.org&#39;, port 1234; and to create an UNIX domain socket identified as &#39;my_socket&#39; as its output IFC.\n&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;   <span class="stringliteral">&quot;Supported interface types:\n&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;   <span class="stringliteral">&quot;==========================\n&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;   <span class="stringliteral">&quot;TCP interface (&#39;t&#39;)\n&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;   <span class="stringliteral">&quot;-------------------\n&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;   <span class="stringliteral">&quot;Communicates through a TCP socket. Output interface listens on a given port, input interface connects to it. There may be more than one input interfaces connected to one output interface, every input interface will get the same data.\n&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   <span class="stringliteral">&quot;Parameters when used as INPUT interface:\n&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <span class="stringliteral">&quot;t:&lt;hostname or ip&gt;:&lt;port&gt;\n&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   <span class="stringliteral">&quot;or\n&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   <span class="stringliteral">&quot;t:&lt;port&gt;\n&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   <span class="stringliteral">&quot;If you skip `&lt;hostname or ip&gt;:`, IFC assumes you want to use localhost as the hostname.\n&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   <span class="stringliteral">&quot;Parameters when used as OUTPUT interface:\n&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   <span class="stringliteral">&quot;&lt;port&gt;:&lt;max_num_of_clients&gt;\n&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   <span class="stringliteral">&quot;Maximal number of connected clients (input interfaces) is optional (64 by default).\n&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   <span class="stringliteral">&quot;TLS interface (&#39;T&#39;)\n&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <span class="stringliteral">&quot;-------------------\n&quot;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   <span class="stringliteral">&quot;Communicates through a TCP socket after establishing encrypted connection. You have to provide certificate, key and CA chain file with trusted CAs. Otherwise same as in TCP: Output interface listens on a given port, input interface connects to it. There may be more than one input interfaces connected to one output interface, every input interface will get the same data.\n&quot;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   <span class="stringliteral">&quot;Parameters when used as INPUT interface:\n&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   <span class="stringliteral">&quot;T:&lt;hostname or ip&gt;:&lt;port&gt;:&lt;keyfile&gt;:&lt;certfile&gt;:&lt;CAfile&gt;\n&quot;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <span class="stringliteral">&quot;or\n&quot;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="stringliteral">&quot;T:&lt;port&gt;:&lt;keyfile&gt;:&lt;certfile&gt;:&lt;CAfile&gt;\n&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <span class="stringliteral">&quot;If you skip `&lt;hostname or ip&gt;:`, IFC assumes you want to use localhost as a hostname.\n&quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   <span class="stringliteral">&quot;Parameters when used as OUTPUT interface:\n&quot;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   <span class="stringliteral">&quot;&lt;port&gt;:&lt;max_num_of_clients&gt;:&lt;keyfile&gt;:&lt;certfile&gt;:&lt;CAfile&gt;\n&quot;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <span class="stringliteral">&quot;Maximal number of connected clients (input interfaces) is optional (64 by default).\n&quot;</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <span class="stringliteral">&quot;Parameters keyfile, certfile, CAfile expect a path to apropriate files in PEM format.\n&quot;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   <span class="stringliteral">&quot;UNIX domain socket (&#39;u&#39;)\n&quot;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   <span class="stringliteral">&quot;------------------------\n&quot;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <span class="stringliteral">&quot;Communicates through a UNIX socket. Output interface creates a socket and listens, input interface connects to it. There may be more than one input interfaces connected to one output interface, every input interface will get the same data.\n&quot;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   <span class="stringliteral">&quot;Parameters when used as INPUT interface:\n&quot;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   <span class="stringliteral">&quot;&lt;socket_name&gt;\n&quot;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <span class="stringliteral">&quot;Socket name can be any string usable as a file name.\n&quot;</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   <span class="stringliteral">&quot;Parameters when used as OUTPUT interface:\n&quot;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   <span class="stringliteral">&quot;&lt;socket_name&gt;:&lt;max_num_of_clients&gt;\n&quot;</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   <span class="stringliteral">&quot;Socket name can be any string usable as a file name.\n&quot;</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   <span class="stringliteral">&quot;Maximal number of connected clients (input interfaces) is optional (64 by default).\n&quot;</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   <span class="stringliteral">&quot;Blackhole interface (&#39;b&#39;)\n&quot;</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <span class="stringliteral">&quot;-------------------------\n&quot;</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="stringliteral">&quot;Can be used as OUTPUT interface only. Does nothing, everything sent to this interface is dropped. It has no parameters.\n&quot;</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   <span class="stringliteral">&quot;File interface (&#39;f&#39;)\n&quot;</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   <span class="stringliteral">&quot;--------------------\n&quot;</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <span class="stringliteral">&quot;Input interface reads data from given files, output interface stores data to multiple files. Recommended file name extension for files with captured TRAP traffic is `.trapcap`. Tilde (`~`) can be used to specify home directory when specifying path, e.g. `~/nemea/data.trapcap`.\n&quot;</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="stringliteral">&quot;Input interface:\n&quot;</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   <span class="stringliteral">&quot;Files to be read by input interface can be specified with globbing.\n&quot;</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   <span class="stringliteral">&quot;E.g. lets say, we have multiple data files captured on 18th of April 2016, with names like data.201604180900, data.201604181000.\n&quot;</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   <span class="stringliteral">&quot;Following syntax can be used:\n&quot;</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   <span class="stringliteral">&quot;&lt;file_name&gt;   // e.g. data.201604180900 - reads data only from file \&quot;data.201604180900\&quot;\n&quot;</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <span class="stringliteral">&quot;&lt;file_name*&gt;  // e.g. data.20160418* - reads data from all files in directory that were captured on 18th of April.\n&quot;</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   <span class="stringliteral">&quot;Name of file (path to the file) must be specified.\n&quot;</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   <span class="stringliteral">&quot;Input file interface can also read from /dev/stdin.\n&quot;</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   <span class="stringliteral">&quot;Output interface:\n&quot;</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <span class="stringliteral">&quot;&lt;file_name&gt;:&lt;mode&gt;:&lt;time=&gt;:&lt;size=&gt;\n&quot;</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   <span class="stringliteral">&quot;Name of file (path to the file) must be specified.\n&quot;</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <span class="stringliteral">&quot;Mode is optional. There are two types of mode: `a` - append (default), `w` - write.\n&quot;</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <span class="stringliteral">&quot;If the specified file exists, mode write overwrites it, mode append creates a new file with an integer suffix, e.g. `data.trapcap.0` (or `data.trapcap.1` if the former exists, and so on, it simply finds the first unused number).\n&quot;</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   <span class="stringliteral">&quot;If parameter `time=` is set, the output interface will split captured data to individual files as often, as value of this parameter indicates.\n&quot;</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   <span class="stringliteral">&quot;Output interface assumes the value of parameter `time=` is in minutes.\n&quot;</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   <span class="stringliteral">&quot;If parameter `time=` is set, the output interface creates unique file name for each file according to current timestamp in format: filename.YYYYmmddHHMM\n&quot;</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   <span class="stringliteral">&quot;Parameter `time=` is optional and is not set by default.\n&quot;</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   <span class="stringliteral">&quot;If parameter `size=` is set, the output interface will split captured data to individual files after size of current file exceeds given threshold.\n&quot;</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   <span class="stringliteral">&quot;Output interface assumes the value of parameter `size=` is in MB.\n&quot;</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;   <span class="stringliteral">&quot;If parameter `size=` is set, numeric suffix as added to original file name for each file in ascending order starting with 0.\n&quot;</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   <span class="stringliteral">&quot;Parameter `size=` is optional and is not set by default.\n&quot;</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   <span class="stringliteral">&quot;If both `time=` and `size=` are specified, the data are split primarily by time, and only if a file of one time interval exceeds the size limit, it is further splitted. The index of size-splitted file is appended after the time, e.g. `data.trapcap.201604181000.0`.\n&quot;</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   <span class="stringliteral">&quot;Example:\n&quot;</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <span class="stringliteral">&quot;-i \&quot;f:~/nemea/data.trapcap:w\&quot;             // stores all captured data to one file (overwrites current file if it exists)\n&quot;</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   <span class="stringliteral">&quot;-i \&quot;f:~/nemea/data.trapcap:w:time=30\&quot;        // creates individual files each 30 minutes, e.g. \&quot;data.trapcap.201604180930\&quot;, \&quot;data.trapcap.201604181000\&quot; etc.\n&quot;</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <span class="stringliteral">&quot;-i \&quot;f:~/nemea/data.trapcap:w:size=100\&quot;       // creates file \&quot;data.trapcap\&quot; and when its size reaches 100 MB, a new file named \&quot;data.trapcap.0\&quot;, then \&quot;data.trapcap.1\&quot; etc.\n&quot;</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   <span class="stringliteral">&quot;-i \&quot;f:~/nemea/data.trapcap:w:time=30:size=100\&quot;  // creates set of files \&quot;data.trapcap.201604180930\&quot;, \&quot;data.trapcap.201604180930.0\&quot; etc. and after 30 minutes, \&quot;data.trapcap.201604181000\&quot;\n&quot;</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <span class="stringliteral">&quot;Output file interface and negotiation:\n&quot;</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <span class="stringliteral">&quot;Whenever new format of data is created, output interface creates new file with numeric suffix.\n&quot;</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="stringliteral">&quot;Example: `-i \&quot;f:~/nemea/data.trapcap:w\&quot;` following sequence of files will be created if data format changes: data.trapcap, data.trapcap.0, data.trapcap.1 etc.\n&quot;</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   <span class="stringliteral">&quot;When mode `a` is specified, the interface finds first non-existing file in which it writes data.\n&quot;</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <span class="stringliteral">&quot;Example: \n&quot;</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <span class="stringliteral">&quot;Assume we have already files \&quot;data.trapcap\&quot; and \&quot;data.trapcap.0\&quot;, the following command:\n&quot;</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   <span class="stringliteral">&quot;-i \&quot;f:~/nemea/data.trapcap:a\&quot;\n&quot;</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="stringliteral">&quot;checks for existing files and first captured data will be stored to file \&quot;data.trapcap.1\&quot;.\n&quot;</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   <span class="stringliteral">&quot;Output file interface can also write data to /dev/stdout and /dev/null, however mode `w` must be specified.\n&quot;</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <span class="stringliteral">&quot;Common IFC parameters\n&quot;</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   <span class="stringliteral">&quot;=====================\n&quot;</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <span class="stringliteral">&quot;The following parameters can be used with any type of IFC. There are parameters of libtrap IFC that are normally let default or set in source codes of a module. It is possible to override them by user via IFC_SPEC. The available parameters are:\n&quot;</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="stringliteral">&quot;* timeout - time in microseconds that an IFC can block waiting for message send / receive\n&quot;</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="stringliteral">&quot;   * possible values: number of microseconds or one of the special values:\n&quot;</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   <span class="stringliteral">&quot;     * \&quot;WAIT\&quot; - block indefinitely\n&quot;</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   <span class="stringliteral">&quot;     * \&quot;NO_WAIT\&quot; - don&#39;t block \n&quot;</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <span class="stringliteral">&quot;     * \&quot;HALF_WAIT\&quot; (output IFC only) - block only if some client (input IFC) is connected\n&quot;</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   <span class="stringliteral">&quot;   * default: WAIT\n&quot;</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   <span class="stringliteral">&quot;* buffer (OUTPUT only) - buffering of data and sending in larger bulks (increases throughput)\n&quot;</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <span class="stringliteral">&quot;   * possible values: on, off\n&quot;</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <span class="stringliteral">&quot;   * default: on\n&quot;</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   <span class="stringliteral">&quot;* autoflush - normally data are not sent until the buffer is full. When autoflush is enabled, even non-full buffers are sent every X microseconds.\n&quot;</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   <span class="stringliteral">&quot;   * possible values: off, number of microseconds\n&quot;</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   <span class="stringliteral">&quot;   * default: 500000 (0.5s)\n&quot;</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   <span class="stringliteral">&quot;Example: `-i u:inputsocket:timeout=WAIT,u:outputsocket:timeout=500000:buffer=off:autoflush=off`\n&quot;</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   <span class="stringliteral">&quot;More examples:\n&quot;</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <span class="stringliteral">&quot;==============\n&quot;</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <span class="stringliteral">&quot;my_module with 1 input interface and 2 output interfaces:\n&quot;</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <span class="stringliteral">&quot;./my_module -i \&quot;t:localhost:12345,b:,t:23456:5\&quot;\n&quot;</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   <span class="stringliteral">&quot;The input interface will connect to localhost:12345 (TCP). The first output interface is unused (all data send there will be dropped), the second output interface will provide data on TCP port 23456, to which another module can connect its input interface.\n&quot;</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   <span class="stringliteral">&quot;nfdump_reader module that reads nfdump file and drops records via Blackhole IFC type:\n&quot;</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   <span class="stringliteral">&quot;./modules/nfreader/nfdump_reader -i b: ./file.nfdump\n&quot;</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="ttc" id="help__trapifcspec_8c_html_ad42ed2f9863287a22ef816d79e4cc4ab"><div class="ttname"><a href="help__trapifcspec_8c.html#ad42ed2f9863287a22ef816d79e4cc4ab">trap_help_ifcspec</a></div><div class="ttdeci">const char * trap_help_ifcspec</div><div class="ttdef"><b>Definition:</b> <a href="help__trapifcspec_8c_source.html#l00001">help_trapifcspec.c:1</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
