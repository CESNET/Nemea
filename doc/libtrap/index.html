<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libtrap: Libtrap</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libtrap
   &#160;<span id="projectnumber">1.16.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Libtrap </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>TRAP is represented by a shared object called libtrap. It is dynamically linked with every Nemea module. This library implements the communication interfaces used by all Nemea modules to exchange data. There are different types of interfaces using various underlying methods of communication (TCP/IP, Unix domain socket, shared memory) and each interface has several parameters. However, libtrap abstracts a module from the underlying interface and its specifics. The main features of libtrap are: </p><ul>
<li>
Blocking or non-blocking mode of transmission based on configuration parameters </li>
<li>
Buffering for throughput increase </li>
<li>
Automatic reconnection after failure </li>
<li>
Local or remote machine communication </li>
</ul>
<p>The interface type and behaviour is fully configurable by module and is usually set by user when module starts. Because some interface types support communication over a network, the system may be easily distributed on several hosts.</p>
<p>Libtrap supplies <a class="el" href="group__simpleapi.html">Simple API</a> and <a class="el" href="group__contextapi.html">Context API</a>, both using <a class="el" href="group__commonapi.html">Common libtrap API</a>. For writing new Nemea modules, <a class="el" href="group__modulemacros.html">Nemea module macros</a> can be useful.</p>
<p>The example of usage in pseudocode: </p><div class="fragment"><div class="line"><a class="code" href="trap_8h.html#a008a51aeb2d1f379beb493108407ce97">trap_ctx_t</a> *ctx = NULL;</div><div class="line"><span class="keywordtype">int</span> res;</div><div class="line">ctx = <a class="code" href="group__contextapi.html#ga0401aae8bc25cfd01b1124baf7bd863a">trap_ctx_init</a>(...);</div><div class="line"><span class="keywordflow">if</span> (ctx != NULL) {</div><div class="line">   <a class="code" href="group__contextapi.html#ga5ef43a88e58beb25cfbceed7643e5fba">trap_ctx_ifcctl</a>(ctx, <a class="code" href="group__ifctypes.html#ggac188fb5e77d8af514d8091c21a9570c8a3465118a68f82fd201ec4ce516f687aa">TRAPIFC_OUTPUT</a> <span class="comment">/* direction */</span>,</div><div class="line">       0 <span class="comment">/* ifc index */</span>, <a class="code" href="group__commonapi.html#ggac99821743a91f2288f5ea8d3ae6b424ca7c42332f519ee4671d7f674198d6a023">TRAPCTL_SETTIMEOUT</a>,</div><div class="line">       <a class="code" href="group__trap__timeout.html#gaca9cc2b565d7f211242da01fd963cc41">TRAP_HALFWAIT</a>);</div><div class="line">   res = <a class="code" href="group__contextapi.html#ga000e7c5b259aad735f066f2e5e8529bb">trap_ctx_recv</a>(ctx, 0 <span class="comment">/* in ifc idx */</span>, &amp;d, &amp;ds);</div><div class="line">   <span class="keywordflow">if</span> (res != <a class="code" href="group__errorcodes.html#ga6aabff248f6e15e2e53b06cfd1e8349a">TRAP_E_OK</a>) {</div><div class="line">     <span class="comment">/* recv failed */</span></div><div class="line">   }</div><div class="line">   res = <a class="code" href="group__contextapi.html#ga9201daf1d4b3123b1caeab26e50c3a61">trap_ctx_send</a>(ctx, 0 <span class="comment">/* out ifc idx */</span>, d, ds);</div><div class="line">   <span class="keywordflow">if</span> (res != <a class="code" href="group__errorcodes.html#ga6aabff248f6e15e2e53b06cfd1e8349a">TRAP_E_OK</a>) {</div><div class="line">     <span class="comment">/* send failed */</span></div><div class="line">   }</div><div class="line">   <a class="code" href="group__contextapi.html#ga5b84d682c3c68fe814896f7f002b319b">trap_ctx_finalize</a>(&amp;ctx);</div><div class="line">}</div></div><!-- fragment --><p>To initialize libtrap, module_info and ifc_spec must be provided. The <a class="el" href="group__commonapi.html#gaefbccf1d04407e6d79ab4b8a8307cdf9">trap_parse_params()</a> function can be used to prepare ifc_spec from process arguments.</p>
<p>The <a class="el" href="structtrap__module__info__s.html">trap_module_info_s</a> parameter is usually defined in the beginning of Nemea modules. It contains module's name and description. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
